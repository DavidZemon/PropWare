<reference-nav></reference-nav>

<div class="container">
  <div class="row">
    <h1>CMake Reference</h1>

    <h2>Introduction</h2>

    <p>This is a quick-reference guide for all CMake variables, functions and macros provided by PropWare's build
      system, as well as some frequently used parts of the standard CMake build system. Be sure to also check out
      CMake's official documentation at <a target="_blank" href="http://cmake.org/cmake/help/documentation.html">
        cmake.org</a>. Remember that PropWare requires CMake 3.3+.</p>

    <h2>Project Languages</h2>

    <p>CMake will default to enabling only C and C++ in your project. If your project uses more than these two
      languages, you must add them with either the
      <a href="https://www.cmake.org/cmake/help/v3.0/command/project.html#command:project">project</a> or
      <a href="https://www.cmake.org/cmake/help/v3.0/command/enable_language.html#command:enable_language">enable_language</a>
      function.</p>

    <h2>Functions</h2>

    <h3><code>create_simple_executable</code></h3>

    <p>Add an executable to the project using the specified source files. Signature matches CMake's built-in
      <a href="https://cmake.org/cmake/help/v3.3/command/add_executable" target="_blank"><code>add_executable</code></a>.
    </p>

    <pre><code hljs hljs-language="cmake" hljs-no-escape>add_executable(&lt;name&gt; [WIN32] [MACOSX_BUNDLE]
               [EXCLUDE_FROM_ALL]
               source1 [source2 ...])</code></pre>

    <ul>
      <li>All source files must be defined in the <code>create_simple_executable</code> function.
      </li>
      <li>Each source file is separated by any amount of whitespace</li>
      <li>Normal C and C++ files do not need their extensions explicitly defined.</li>
      <li>The various COG languages <em>do</em> need their extensions explicitly defined, as does assembly.</li>
      <li>The following PropWare-specific targets will be created:
        <ul>
          <li><code>run</code>: Load the executable to EEPROM and execute the code.</li>
          <li><code>run-ram</code>: Load the executable to HUB RAM and execute the code.</li>
          <li><code>run-sd-loader</code>: Load the executable to SD card, and execute the code.</li>
          <li><code>run-sd-cache</code>: Load the executable to SD card, use it as a cache, and execute the code</li>
          <li><code>debug</code>: Load the executable to HUB RAM, execute the code, and open an interactive serial
            terminal
          </li>
          <li><code>debug-eeprom</code>: Load the executable to EEPROM, execute the code, and open an interactive serial
            terminal
          </li>
          <li><code>debug-sd-loader</code>: Load the executable to SD card, execute the code, and open an interactive
            serial terminal
          </li>
          <li><code>debug-sd-cache</code>: Load the executable to SD card, use it as a cache, execute the code, and open
            an interactive serial terminal
          </li>
          <li><code>gdb</code>: Load the executable to HUB RAM and start GDB</li>
        </ul>
      </li>
    </ul>

    <h3><code>create_executable</code></h3>

    <p>Exactly the same as <code>create_simple_executable</code>, except each target will be suffixed with
      <code>-EXECUTABLE_NAME</code>, allowing multiple executables in a single project. For instance,
      <code>create_executable(MyExe MySource.cpp)</code> would result in creating the target <code>run-MyExe</code>.</p>

    <h3><code>create_library</code></h3>

    <h2>PropWare CMake Variables</h2>

    <h3 id="common_flags">COMMON_FLAGS</h3>

    <p>Flags applied to all PropGCC languages</p>

    <h3 id="common_cog_flags">COMMON_COG_FLAGS</h3>

    <p>Flags applied to COGC, ECOGC, COGCXX, and ECOGXX</p>

    <h3 id="lang_flags">&lt;LANG&gt;_FLAGS</h3>

    <p>Compilation flags used for a specific language.</p>

    <ul>
      <li>Note that C_FLAGS will be applied to C, COGC, and ECOGC and likewise for CXX_FLAGS</li>
      <li>Note that COGC_FLAGS will be applied after C_FLAGS and will therefore override any conflicting flags
        in
        the C_FLAGS variable (likewise for ECOGC, COGCXX, and ECOGCXX)
      </li>
    </ul>

    <h3 id="model">MODEL</h3>

    <p>[default: <code>lmm</code>]</p>

    <p>This option should be one of <code>cog</code>, <code>cmm</code>, <code>lmm</code>,
      <code>xmm-single</code>,
      <code>xmm-split</code>, or <code>xmmc</code>. Read more about PropGCC's
      memory models <a href="https://code.google.com/p/propgcc/wiki/PropGccInDepth">here</a>.</p>

    <h3 id="board">BOARD</h3>

    <p>Used to identify your physical hardware. PropGCC uses this to determine how many bytes of EEPROM, default
      baud rate for RS232, and other functions. Any board available in SimpleIDE is available here as well -
      they are reading from the same configuration pool (<code>&lt;PropGCC root&gt;/propeller-load</code>).
    </p>

    <h2>Options</h2>

    <p>CMake options allow you to have fine-grain control over what compilation flags are used by default. Most
      users will want to leave all options set to their default values, but those doing special projects or
      using conflicting libraries can change the options to suit their needs.</p>

    <h3>AUTO_OPTIMIZATION</h3>

    <p>[default: ON]</p>

    <p>Sets the optimization level for size. Equivalent to adding "-Os" to <code>COMMON_FLAGS</code>.</p>

    <h3>WARN_ALL</h3>

    <p>[default: ON]</p>

    <p>Turns on many common warnings from the compiler. Aids in writing clean, error-free code. Equivalent to adding
      "-Wall" to <code>COMMON_FLAGS</code>.</p>

    <h3>32_BIT_DOUBLES</h3>

    <p>[default: ON]</p>

    <p>Sets all variables of type <code>double</code> to use IEEE 32-bit floating point instead of 64.
      Equivalent to
      adding "-m32bit-doubles" to <code>COMMON_FLAGS</code>. Required for compatibility with numerous
      functions
      in the Simple library.</p>

    <h3>AUTO_C_STD</h3>

    <p>[default: ON]</p>

    <p>Sets the C standard to C99. Equivalent to adding "-std=c99" to <code>C_FLAGS</code></p>

    <h3><a id="AUTO_CXX_STD_133"></a>AUTO_CXX_STD</h3>

    <p>[default: ON]</p>

    <p>Sets the C++ standard to the latest available for the compiler. This is <code>gnu++0x</code> in GCC 4.6.1
      (current PropGCC) and <code>gnu++14</code> in GCC5 version of PropGCC. Equivalent to adding
      "-std=&lt;standard&gt;" to <code>CXX_FLAGS</code>.</p>

    <h2>Default Compile Flags</h2>

    <p>With all options left at their defaults, the following flags will be used. There is currently no option
      to
      disable <code>-fno-threadsafe-statics -fno-rtti</code>. If such an option is required, let the
      <a href="mailto:david@zemon.name">author</a> know and an option will be added. It is believed that these
      flags will always be desired by Propeller users.</p>

    <dl>
      <dt>ASM</dt>
      <dd>None</dd>
      <dt>C</dt>
      <dd><code>-Wall -Os -m32bit-doubles -std=c99</code></dd>
      <dt>COGC</dt>
      <dd><code>-Wall -Os -m32bit-doubles -std=c99 -mcog -xc -r</code></dd>
      <dt>ECOGC</dt>
      <dd><code>-Wall -Os -m32bit-doubles -std=c99 -mcog -xc -r</code></dd>
      <dt>CXX</dt>
      <dd><code>-Wall -Os -m32bit-doubles -std=gnu++0x -fno-threadsafe-statics -fno-rtti</code></dd>
      <dt>COGCXX</dt>
      <dd><code>-Wall -Os -m32bit-doubles -std=gnu++0x -fno-threadsafe-statics -fno-rtti -mcog -xc++-r</code>
      </dd>
      <dt>ECOGCXX</dt>
      <dd><code>-Wall -Os -m32bit-doubles -std=gnu++0x -fno-threadsafe-statics -fno-rtti -mcog -xc++-r</code>
      </dd>
      <dt>Linker</dt>
      <dd>None</dd>
      <dt>Archiver</dt>
      <dd><code>cr</code></dd>
    </dl>
  </div>
</div>
